---
date:           2021-03-16
category:       前端
title:          vite-1.0 CSS插件解读
tags:           [vite, 源代码]
---

这个`serverPluginCss`是用来处理CSS文件的，因为在vite里面CSS（包括SCSS这种预处理器）和JSON都被处理成JS module，然后再由HTML里面注入的`src/client/client.ts`来更新页面。
<!--more-->

## 正常的请求处理

![server-plugin-css-main](/assets/images/vite/server-plugin-css-main.png)

第28行用到的方法判断如下，就是简单的判断文件名：
![server-plugin-css-re](/assets/images/vite/server-plugin-css-re.png)
第32行的这个根据文件名生成哈希值就很有意思了，我在这里展开讲：[]()

## 参考：

[A Quick Look at Constructable Stylesheets](https://dev.to/overrideveloper/a-first-look-at-constructable-stylesheets-3ae)
[What is the Shadow DOM?](https://bitsofco.de/what-is-the-shadow-dom)
[Constructable Stylesheet Objects](https://wicg.github.io/construct-stylesheets/)
